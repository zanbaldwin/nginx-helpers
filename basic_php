location / {
    try_files $uri $uri/ /index.php$is_args$args;
}

location ~ \.(css|js)$ {
    gzip on;
}

include helpers/global_restrictions;
include helpers/no_log_assets;

# Pass all PHP files onto PHP's Fast Process Manager server.
location ~ [^/]\.php(/|\?|$) {
    fastcgi_split_path_info ^(.+?\.php)(/.*)$;
    if (!-f $document_root$fastcgi_script_name) {
        return 404;
    }
    try_files $uri $fastcgi_script_name =404;
    fastcgi_index index.php;
    include fastcgi_params;
    fastcgi_pass phpfpm;
}
